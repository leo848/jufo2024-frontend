<script lang="ts">
	import { dark } from '../ui/darkmode';
	import type { Color } from '../color/color';
	import { HslColor, RgbColor } from '../color/colorSpaces';
	import { PerceptualGradient } from '../color/gradient';

	const letters = 'sorting the colors'.split('');

	const sortedLists = [
		[
			[0.714643732955081, 0.9138342431502059, 0.33957637037281074],
			[0.05649501765274845, 0.684543480211706, 0.18080147598568852],
			[0.23916209246080156, 0.6321572401839365, 0.34392382289104273],
			[0.5927774399633744, 0.5506949910905176, 0.2590280577968176],
			[0.6956281462840141, 0.5189783439849411, 0.16965545755791378],
			[0.9113382802072718, 0.23447786714662255, 0.24209445140897434],
			[0.6731042828393375, 0.39059700291549826, 0.7079062544032315],
			[0.40601466985345835, 0.343818154574985, 0.8452452447956357],
			[0.5420059752540954, 0.24692704384155773, 0.6202720240965066],
			[0.49264490809810746, 0.002104005503550499, 0.4837763227892171]
		],
		[
			[0.24091961638851866, 0.12924298457171302, 0.6720810738799651],
			[0.560512867892514, 0.07576798589805078, 0.24412529686667928],
			[0.9262562679563179, 0.3841078054492849, 0.7183966688865974],
			[0.728881111333178, 0.5263643308925237, 0.7395807391034049],
			[0.8920454442982435, 0.42570407116187103, 0.08634984078396635],
			[0.8239515624639255, 0.7194790170622053, 0.21727606844767666],
			[0.16300419122085097, 0.9891802694338094, 0.5658817905460843],
			[0.0823673162944929, 0.9895352251992657, 0.7818641350350015],
			[0.34404925303642986, 0.8106618720983575, 0.7745879723183806],
			[0.13894297502009734, 0.4680556430509816, 0.23281492213261]
		],
		[
			[0.227172855771286, 0.8848472265903984, 0.6862143870180833],
			[0.19451985464399202, 0.5602194081483061, 0.18448541779219763],
			[0.05721842271096533, 0.2829774623940712, 0.23876666014126102],
			[0.3648700141826381, 0.4094328633995047, 0.5815232676502519],
			[0.6268087708257222, 0.3458585977833699, 0.5314634624574903],
			[0.5829839837172651, 0.4612801904893379, 0.7050244732893741],
			[0.9692129056775443, 0.6566236564334791, 0.8142064893762674],
			[0.9378833847120298, 0.6240693697860833, 0.628440736500218],
			[0.9798102477935436, 0.8000873718708593, 0.707950188419913],
			[0.9503127611946945, 0.8644881391130957, 0.9485140282239565]
		],
		[
			[0.40765708612369134, 0.9895244925648965, 0.08366294924996842],
			[0.3044402342517981, 0.7609188436379541, 0.19188455515452407],
			[0.9485352737321878, 0.5476751549142769, 0.17906074407249872],
			[0.6485396126236378, 0.2522935255591, 0.03124927050140358],
			[0.37416807760437687, 0.5904805168150282, 0.7667582472792058],
			[0.4221641590008739, 0.3486332354233814, 0.8184520393160379],
			[0.2132149446049424, 0.21533619093988787, 0.8458342168105354],
			[0.2388279810078987, 0.3506288493077828, 0.6783475254855396],
			[0.27916985853604503, 0.300278307194752, 0.510891853840144],
			[0.07432553087079996, 0.07356892694300077, 0.2410381125180736]
		],
		[
			[0.8398590498561456, 0.3839790929247413, 0.9546436608818503],
			[0.6323323297614685, 0.4533300145798346, 0.8440215427440155],
			[0.026220207977534882, 0.07538970858058047, 0.9999619945078166],
			[0.21078870652645232, 0.029324077145785665, 0.601297444977624],
			[0.20053742084990733, 0.2659171427417585, 0.257805391739936],
			[0.2149631302457915, 0.4066019895657452, 0.5773629674784531],
			[0.36457095083778324, 0.4376673993447774, 0.3916310609581778],
			[0.03324221649444825, 0.6799355646220777, 0.563225099401485],
			[0.1767814046474563, 0.6935520887109695, 0.48593168921053687],
			[0.22462676472668308, 0.7489828933031295, 0.15923550134075592]
		],
		[
			[0.5839403652892365, 0.887468529485255, 0.24460059644631948],
			[0.8891554528307961, 0.8706240340632684, 0.44303587732229777],
			[0.8879418306149647, 0.906994656477123, 0.8257269760073731],
			[0.8364389743428737, 0.6838172656811018, 0.5504001549542076],
			[0.7417369632654379, 0.264248132176104, 0.15304444211525448],
			[0.5319120990283843, 0.058574617334610335, 0.33571899149755424],
			[0.7771094886675852, 0.4566369364731143, 0.8083298078769134],
			[0.5267704595030981, 0.5973256761880948, 0.9284026012384645],
			[0.20346496455268315, 0.49121097372980616, 0.46846044103923457],
			[0.04676188660515124, 0.14358157018376316, 0.9839893732609333]
		],
		[
			[0.08908338749776157, 0.10744950553422816, 0.681600146068744],
			[0.46036024915458484, 0.18357321455842412, 0.8939611234621008],
			[0.6145140726363227, 0.007552065448241718, 0.80883766553633],
			[0.4230157352937526, 0.04773946588469602, 0.4337646654917161],
			[0.5273309670990876, 0.22061344966297902, 0.42397223621224756],
			[0.8473677534785492, 0.15589197729719984, 0.2000801486457684],
			[0.5961730543508138, 0.5366789309022205, 0.7420797371004063],
			[0.9982211587581701, 0.5644124295164711, 0.5800823016155269],
			[0.8551226441469255, 0.7092782459826513, 0.5052613366575923],
			[0.5395842617098305, 0.8074100983667467, 0.14479794780653288]
		],
		[
			[0.1755251242120066, 0.4323693079958202, 0.7248735547930677],
			[0.5903398499186886, 0.0149049683889515, 0.8315457559136435],
			[0.7747691281295324, 0.02085693571834002, 0.7511312457352151],
			[0.8851117857152732, 0.47312371033492095, 0.9012562224088625],
			[0.9122377449247825, 0.8564807413534656, 0.8540753554959335],
			[0.6461292600725994, 0.8984082621084186, 0.4504497086660849],
			[0.7552355679337834, 0.5464329219312072, 0.4141913920522625],
			[0.5839894319700935, 0.21646221999956705, 0.09048879326319437],
			[0.3426045051138652, 0.2329236715939692, 0.032488707149188945],
			[0.2596411249238674, 0.056024881458935694, 0.1684251132586324]
		],
		[
			[0.7910109768379516, 0.8379692397591351, 0.033861325098964445],
			[0.30174782998949123, 0.9935452409759439, 0.42981937330770403],
			[0.16491039721219092, 0.7522316908941612, 0.40917921388944656],
			[0.6084817651318654, 0.6336838371615342, 0.020869966342470625],
			[0.46150428866222926, 0.5513497305075146, 0.4003888279941944],
			[0.734147115592592, 0.2719806553685894, 0.18129889516095155],
			[0.9912241401814093, 0.30030893150820726, 0.06980435336531476],
			[0.8550658019525474, 0.10051224003658987, 0.5436293521863573],
			[0.7897231895466384, 0.37681424513525563, 0.834263329519224],
			[0.5652741053390675, 0.027044270161073136, 0.5916391439933429]
		],
		[
			[0.16862817422728227, 0.039909614644193736, 0.5182775153668833],
			[0.23086470766650125, 0.14757563371489246, 0.051670414873290715],
			[0.49571092230552505, 0.09186065939583932, 0.24148831423892336],
			[0.5915369284921667, 0.41118913652464917, 0.1629236814032139],
			[0.4949790017021447, 0.6186781310868927, 0.05514097799862039],
			[0.3429026327422753, 0.7438999287014352, 0.15781233827566055],
			[0.0015049116399881157, 0.8923051974971359, 0.013250913456795077],
			[0.6126745724276259, 0.7918225261032569, 0.23922281384160848],
			[0.022502665771203634, 0.7146450438812695, 0.6400886481469803],
			[0.08506439723845349, 0.9089320263216611, 0.8738255504296263]
		],
		[
			[0.16862817422728227, 0.039909614644193736, 0.5182775153668833],
			[0.23086470766650125, 0.14757563371489246, 0.051670414873290715],
			[0.49571092230552505, 0.09186065939583932, 0.24148831423892336],
			[0.5915369284921667, 0.41118913652464917, 0.1629236814032139],
			[0.4949790017021447, 0.6186781310868927, 0.05514097799862039],
			[0.3429026327422753, 0.7438999287014352, 0.15781233827566055],
			[0.0015049116399881157, 0.8923051974971359, 0.013250913456795077],
			[0.6126745724276259, 0.7918225261032569, 0.23922281384160848],
			[0.022502665771203634, 0.7146450438812695, 0.6400886481469803],
			[0.08506439723845349, 0.9089320263216611, 0.8738255504296263]
		],
		[
			[0.030530225165322333, 0.2830120111590838, 0.22356070465788336],
			[0.1616305512022007, 0.24898237424669611, 0.2539729127325714],
			[0.04123128791256769, 0.09195390869539133, 0.9435623192716343],
			[0.5983673114331582, 0.10153867709315056, 0.681355862914672],
			[0.6755361400842286, 0.15042195509772682, 0.3791394778933368],
			[0.9113987420991272, 0.2813702450158797, 0.16740407296469795],
			[0.8584228590125119, 0.5906974662829344, 0.11649997385817457],
			[0.693724273487037, 0.7509130029540321, 0.057220780301395324],
			[0.7638303304317655, 0.9349824575987016, 0.391929119940142],
			[0.47892852889850157, 0.9634238402422659, 0.6684714508122335]
		],
		[
			[0.24252314665927532, 0.03512880826348097, 0.11910890306500621],
			[0.0518939720193754, 0.394724613958336, 0.39478015707277514],
			[0.19468862430848288, 0.7704389742875598, 0.34706291990067506],
			[0.8244698712055162, 0.8303840735553015, 0.5508723097413968],
			[0.9295660346354617, 0.5395524522870639, 0.6594920577679854],
			[0.8885199149740906, 0.027540566482053608, 0.8737711766184005],
			[0.6372578013640693, 0.4281168311649378, 0.898674703009857],
			[0.22602470552348686, 0.026311653996261897, 0.9619390828273435],
			[0.1403712072330181, 0.1468743010314697, 0.9703365692533653],
			[0.061565881025517744, 0.060023655606734616, 0.9669835352258608]
		],
		[
			[0.9429743605833772, 0.04897065530659361, 0.3643858281585376],
			[0.7110350222260693, 0.42504573211733654, 0.7553496912533841],
			[0.7745029744417633, 0.537441462583795, 0.98838342987051],
			[0.3514908558137715, 0.11299546692762374, 0.7434208556122387],
			[0.008292376300449988, 0.029011827227282683, 0.5243651571015043],
			[0.21051137743500614, 0.3692409573877603, 0.5842197927488437],
			[0.26223378203673553, 0.41711498181158413, 0.504597003996568],
			[0.42410230023196305, 0.5558930075923042, 0.31342279802830886],
			[0.4444828984705468, 0.9585231008168265, 0.8217180911269647],
			[0.22159606914223595, 0.9835555613206183, 0.2095486645592376]
		]
	].map((list) => list.map(([r, g, b]) => new RgbColor(r, g, b).color().lighten(0.2)));

	let list: Color[] = new Array(5).fill(
		($dark ? new RgbColor(1, 1, 1) : new RgbColor(0, 0, 0)).color()
	);
	$: $dark,
		(() => {
			if (Math.random() < 0.02) {
				list = sortedLists[Math.floor(Math.random() * sortedLists.length)];
			} else {
				list = new Array(100).fill(0).map((_, i) => {
					const color = new HslColor(i / 120, 1, 0.5).color();
					if ($dark) {
						return color.lighten(0.5);
					} else {
						return color.darken(0.5);
					}
				});
			}
		})();

	$: background = new PerceptualGradient(...list);
</script>

<span class="self-center whitespace-nowrap text-3xl font-semibold text-white"
	><a href="/" class="flex-row flex">
		{#each letters as letter, index}
			<div style:color={background.sample(index / (letters.length - 1))?.css()}>
				{#if letter === ' '}&nbsp;{:else}{letter}{/if}
			</div>
		{/each}
	</a></span
>
